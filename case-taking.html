<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Homeopathic Case Taking Form</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f7fb;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.08);
    }
    h1 {
      text-align: center;
      color: #2a4d69;
    }
    h2 {
      margin-top: 25px;
      color: #1e3d59;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 12px;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    textarea { resize: vertical; }
    .row { display: flex; gap: 15px; }
    .row > div { flex: 1; }
    .submit-btn {
      margin-top: 25px;
      background: #2a4d69;
      color: white;
      padding: 12px;
      border: none;
      width: 100%;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
    }
    .submit-btn:hover { background: #1e3d59; }
  </style>
</head>
<body>

<div class="container">
  <h1>Homeopathic Case Taking Form</h1>

  <form id="caseForm">

    <h2>ğŸ‘¤ Patient Information</h2>
    <div class="row">
      <div>
        <label>Full Name</label>
        <input type="text" name="name" required>
      </div>
      <div>
        <label>Age</label>
        <input type="number" name="age" required>
      </div>
    </div>

    <div class="row">
      <div>
        <label>Gender</label>
        <select name="gender">
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select>
      </div>
      <div>
        <label>Phone Number</label>
        <input type="tel" name="phone" required>
      </div>
    </div>

    <label>Email</label>
    <input type="email" name="email">

    <h2>ğŸ©º Main Complaints</h2>
    <textarea name="main_complaint" rows="3" required></textarea>

    <label>Since when are you suffering?</label>
    <input type="text" name="duration">

    <label>What makes it worse?</label>
    <textarea name="aggravation" rows="2"></textarea>

    <label>What makes it better?</label>
    <textarea name="amelioration" rows="2"></textarea>

    <h2>ğŸ§  Mind & Emotions</h2>
    <textarea name="mental_state" rows="3"></textarea>

    <label>Sleep pattern</label>
    <textarea name="sleep" rows="2"></textarea>

    <h2>ğŸ½ General Symptoms</h2>
    <textarea name="appetite" rows="2"></textarea>

    <label>Food cravings or aversions</label>
    <textarea name="cravings" rows="2"></textarea>

    <label>Sweat details</label>
    <textarea name="sweat" rows="2"></textarea>

    <label>Thermal preference</label>
    <select name="thermal">
      <option>Feels more hot</option>
      <option>Feels more cold</option>
      <option>Cannot tolerate heat</option>
      <option>Cannot tolerate cold</option>
    </select>

    <h2>ğŸ©» Past History</h2>
    <textarea name="past_history" rows="3"></textarea>

    <label>Family history</label>
    <textarea name="family_history" rows="2"></textarea>

    <h2>ğŸ’Š Current Medication</h2>
    <textarea name="current_meds" rows="2"></textarea>

    <h2>ğŸ“ Upload Medical Reports</h2>
    <input type="file" name="reports" multiple>

    <button type="submit" class="submit-btn">Submit Case</button>
  </form>
</div>

<!-- ğŸ”¥ Firebase + Form Submission Logic -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAnhR2-KIlypbb4hriWuqFRC3SRk9Zmi2Q",
    authDomain: "immunisphere-f6239.firebaseapp.com",
    projectId: "immunisphere-f6239",
    storageBucket: "immunisphere-f6239.firebasestorage.app",
    messagingSenderId: "141342230101",
    appId: "1:141342230101:web:f9ba568327657e643536dc",
    databaseURL: "https://immunisphere-f6239-default-rtdb.firebaseio.com"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);

  const form = document.getElementById("caseForm");

  form.addEventListener("submit", function(e) {
    e.preventDefault();

    const formData = new FormData(form);
    const caseData = Object.fromEntries(formData.entries());
    const caseId = "CASE_" + Date.now();

    set(ref(database, 'cases/' + caseId), {
      ...caseData,
      caseId: caseId,
      status: "Pending Payment",
      timestamp: new Date().toISOString()
    }).then(() => {
      localStorage.setItem("currentCaseId", caseId);
      window.location.href = "payment.html";
    }).catch((error) => {
      alert("Error saving case: " + error.message);
    });
  });
</script>

</body>
</html>
